

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Frontend Chat Integration Guide &mdash; AI Agent Framework 2.2.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=b21de401"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Model Optimization Strategy" href="model_optimization_strategy.html" />
    <link rel="prev" title="Structured Final Response Pattern" href="structured_final_response.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            AI Agent Framework
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Guides</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#start-here">Start Here</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#howto">How‑To</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#architecture">Architecture</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#additional-guides">Additional Guides</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Frontend Chat Integration Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#endpoints">Endpoints</a></li>
<li class="toctree-l4"><a class="reference internal" href="#request-parameters">Request Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#websocket-event-schema">WebSocket Event Schema</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tool-result-schemas-for-rendering">Tool Result Schemas (for rendering)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ui-flow-recommendations">UI Flow Recommendations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#http-oneshot-response">HTTP (One‑Shot) Response</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model_optimization_strategy.html">Model Optimization Strategy</a></li>
<li class="toctree-l3"><a class="reference internal" href="python_interpreter_debugging.html">Python Interpreter Tool - Debugging &amp; Logging Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategic_planning_architecture.html">Strategic Planning Architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="message_store_integration.html">Implementation Guide: Message Store Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="message_store_format.html">Message Store Format Specification</a></li>
<li class="toctree-l3"><a class="reference internal" href="message_store_implementation.html">Message Store Implementation Guide</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#reference-and-examples">Reference and Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Domain Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../powerbi/index.html">Power BI Domain Example</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Additional Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../framework_guide.html">Framework Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">AI Agent Framework (Overview)</a></li>
<li class="toctree-l1"><a class="reference internal" href="library_architecture.html">Library Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="structured_final_response.html">Structured Final Response Pattern</a></li>
<li class="toctree-l1"><a class="reference internal" href="runtime_loop_stagnation.html">Runtime Loop &amp; Stagnation</a></li>
<li class="toctree-l1"><a class="reference internal" href="observability.html">Observability</a></li>
<li class="toctree-l1"><a class="reference internal" href="message_store_integration.html">Implementation Guide: Message Store Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="message_store_format.html">Message Store Format Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="message_store_implementation.html">Message Store Implementation Guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">AI Agent Framework</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Guides</a></li>
      <li class="breadcrumb-item active">Frontend Chat Integration Guide</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/guides/frontend_chat_integration.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="frontend-chat-integration-guide">
<h1>Frontend Chat Integration Guide<a class="headerlink" href="#frontend-chat-integration-guide" title="Link to this heading"></a></h1>
<p>Goal: help a React developer render real‑time agent activity and results (especially list tools) from the WebSocket stream, and support one‑shot HTTP calls.</p>
<section id="endpoints">
<h2>Endpoints<a class="headerlink" href="#endpoints" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>HTTP (single turn): <code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/run</span></code></p>
<ul>
<li><p>Body: <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">task:</span> <span class="pre">string,</span> <span class="pre">config_path?:</span> <span class="pre">string,</span> <span class="pre">model_dir?:</span> <span class="pre">string</span> <span class="pre">}</span></code></p></li>
<li><p>Response: <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">agent,</span> <span class="pre">task,</span> <span class="pre">result,</span> <span class="pre">events,</span> <span class="pre">memory</span> <span class="pre">}</span></code></p></li>
</ul>
</li>
<li><p>WebSocket (streaming): <code class="docutils literal notranslate"><span class="pre">GET</span> <span class="pre">/ws/agent</span></code></p>
<ul>
<li><p>Send: <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">task:</span> <span class="pre">string,</span> <span class="pre">config_path?:</span> <span class="pre">string,</span> <span class="pre">model_dir?:</span> <span class="pre">string</span> <span class="pre">}</span></code></p></li>
<li><p>Receive a stream of JSON events (see Event Schema below).</p></li>
</ul>
</li>
</ul>
</section>
<section id="request-parameters">
<h2>Request Parameters<a class="headerlink" href="#request-parameters" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">task</span></code> (required): user’s natural language request.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">config_path</span></code> (optional): which agent to run. Examples:</p>
<ul>
<li><p>Orchestrator: <code class="docutils literal notranslate"><span class="pre">configs/agents/orchestrator.yaml</span></code></p></li>
<li><p>Power BI manager: <code class="docutils literal notranslate"><span class="pre">configs/agents/pbi_designer_manager.yaml</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">model_dir</span></code> (recommended for Power BI): directory containing unpacked PBIT (e.g., <code class="docutils literal notranslate"><span class="pre">pbi_data/pbit</span></code>). The server injects it into tools as <code class="docutils literal notranslate"><span class="pre">MODEL_DIR</span></code>.</p></li>
</ul>
</section>
<section id="websocket-event-schema">
<h2>WebSocket Event Schema<a class="headerlink" href="#websocket-event-schema" title="Link to this heading"></a></h2>
<p>Every progress event has this envelope:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>{
  &quot;event&quot;: string,
  &quot;data&quot;?: object,
  &quot;timestamp&quot;: number
}
</pre></div>
</div>
<p>Special final WS message (wrapper) sent after the agent finishes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;event&quot;</span><span class="p">:</span> <span class="s2">&quot;agent_end&quot;</span><span class="p">,</span>
  <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="nb">any</span><span class="p">,</span>
  <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">number</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Initial connection confirmation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="s2">&quot;event&quot;</span><span class="p">:</span> <span class="s2">&quot;connected&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;ready&quot;</span> <span class="p">},</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<p>Common <code class="docutils literal notranslate"><span class="pre">event</span></code> values you’ll receive (chronological):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">manager_start</span></code>: Orchestrator run begins. data: <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">task,</span> <span class="pre">workers:</span> <span class="pre">string[]</span> <span class="pre">}</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">WorkerRouterPlanner.prompt</span></code> and <code class="docutils literal notranslate"><span class="pre">WorkerRouterPlanner.raw_response</span></code> appear at DEBUG in logs (not over WS) when enabled.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">delegation_planned</span></code>: Which worker will run. data: <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">worker</span> <span class="pre">}</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">delegation_chosen</span></code>: Confirmation. data: <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">worker</span> <span class="pre">}</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">agent_start</span></code>: Worker agent begins. data: <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">task</span> <span class="pre">}</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ReActPlanner.raw_response</span></code> appears at DEBUG in logs (not over WS) when enabled.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">action_planned</span></code>: A tool will be called. data: <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">tool,</span> <span class="pre">args</span> <span class="pre">}</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">action_executed</span></code>: Tool finished. data: <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">tool,</span> <span class="pre">result</span> <span class="pre">}</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">error</span></code>: Error encountered. data: <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">message</span> <span class="pre">}</span></code> (from agent) or <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">error</span> <span class="pre">}</span></code> (from WS wrapper on exceptions)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">agent_end</span></code>: Worker finished. data: <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">result</span> <span class="pre">}</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">delegation_executed</span></code>: Back to orchestrator with result. data: <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">worker,</span> <span class="pre">result</span> <span class="pre">}</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">manager_end</span></code>: Orchestrator finished. data: <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">result</span> <span class="pre">}</span></code></p></li>
</ul>
<p>Note: you will see an <code class="docutils literal notranslate"><span class="pre">agent_end</span></code> inside the stream (with <code class="docutils literal notranslate"><span class="pre">data.result</span></code>), and a wrapper <code class="docutils literal notranslate"><span class="pre">agent_end</span></code> message (with <code class="docutils literal notranslate"><span class="pre">result</span></code>) from the WS endpoint after completion. Treat either as “done”; many UIs ignore the wrapper and rely only on streamed events.</p>
</section>
<section id="tool-result-schemas-for-rendering">
<h2>Tool Result Schemas (for rendering)<a class="headerlink" href="#tool-result-schemas-for-rendering" title="Link to this heading"></a></h2>
<p>Each <code class="docutils literal notranslate"><span class="pre">action_executed</span></code> carries <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">tool,</span> <span class="pre">result</span> <span class="pre">}</span></code>. Use <code class="docutils literal notranslate"><span class="pre">tool</span></code> to branch and render <code class="docutils literal notranslate"><span class="pre">result</span></code> appropriately.</p>
<p>TypeScript suggestions:</p>
<div class="highlight-ts notranslate"><div class="highlight"><pre><span></span><span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">AgentEvent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">event</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">data?</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">;</span>
<span class="w">  </span><span class="nx">result?</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">;</span><span class="w"> </span><span class="c1">// present only on wrapper agent_end</span>
<span class="w">  </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// Discriminated union by tool name for action_executed</span>
<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">ToolExecuted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">event</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;action_executed&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">tool</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w"> </span><span class="nx">result</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="w"> </span><span class="p">};</span>
<span class="w">  </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">ListTablesResult</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">tables_dir</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">tables</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">ListColumnsResult</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">table_file</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">table</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">columns</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w"> </span><span class="nx">dataType?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w"> </span><span class="nx">summarizeBy?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">}[];</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">ListMeasuresResult</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">measures</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">table</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">}[];</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">ListRelationshipsResult</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">relationships_file</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">relationships</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">    </span><span class="nx">fromColumn?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">    </span><span class="nx">toColumn?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">    </span><span class="nx">isActive?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">    </span><span class="nx">crossFilteringBehavior?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">    </span><span class="nx">fromCardinality?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="p">}[];</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">ListCalculatedColumnsResult</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">calculated_columns</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">table</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">}[];</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">AddMeasureResult</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">table_file</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">measure_name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w"> </span><span class="c1">// &quot;Measure appended&quot;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">RenameColumnResult</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">table_file</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">old_name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">new_name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w"> </span><span class="c1">// &quot;Column renamed&quot;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">AddRelationshipResult</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">relationships_file</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w"> </span><span class="c1">// &quot;Relationship appended&quot;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">UpdateRelationshipResult</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">relationships_file</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w"> </span><span class="c1">// &quot;Relationship updated&quot;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">TMDLValidateResult</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">model_dir</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">tables_checked</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">relationships_present</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">issues</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">CalculatorResult</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">expression</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">normalized_expression</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">result</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">  </span><span class="nx">note?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">MathQAResult</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">question</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">answer</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Render examples (pseudo‑code):</p>
<div class="highlight-ts notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span><span class="w"> </span><span class="nx">renderActionExecuted</span><span class="p">(</span><span class="nx">e</span><span class="o">:</span><span class="w"> </span><span class="kt">ToolExecuted</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">tool</span><span class="p">,</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
<span class="w">  </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">tool</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;list_tables&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">ListTablesResult</span><span class="p">;</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">r</span><span class="p">.</span><span class="nx">tables</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">t</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">li</span><span class="w"> </span><span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">t</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">t</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;)}&lt;/ul&gt;;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;list_columns&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">ListColumnsResult</span><span class="p">;</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="o">&lt;</span><span class="nx">table</span><span class="o">&gt;</span>
<span class="w">          </span><span class="o">&lt;</span><span class="nx">thead</span><span class="o">&gt;&lt;</span><span class="nx">tr</span><span class="o">&gt;&lt;</span><span class="nx">th</span><span class="o">&gt;</span><span class="nx">Column</span><span class="o">&lt;</span><span class="err">/th&gt;&lt;th&gt;Type&lt;/th&gt;&lt;th&gt;SummarizeBy&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;</span>
<span class="w">          </span><span class="o">&lt;</span><span class="nx">tbody</span><span class="o">&gt;</span>
<span class="w">            </span><span class="p">{</span><span class="nx">r</span><span class="p">.</span><span class="nx">columns</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">c</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">              </span><span class="o">&lt;</span><span class="nx">tr</span><span class="w"> </span><span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">c</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&gt;&lt;</span><span class="nx">td</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">c</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/td&gt;&lt;td&gt;{c.dataType}&lt;/td&gt;&lt;td&gt;{c.summarizeBy}&lt;/td&gt;&lt;/tr&gt;</span>
<span class="w">            </span><span class="p">))}</span>
<span class="w">          </span><span class="o">&lt;</span><span class="err">/tbody&gt;</span>
<span class="w">        </span><span class="o">&lt;</span><span class="err">/table&gt;</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;list_measures&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">ListMeasuresResult</span><span class="p">;</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">r</span><span class="p">.</span><span class="nx">measures</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">m</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">li</span><span class="w"> </span><span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">m</span><span class="p">.</span><span class="nx">table</span><span class="o">+</span><span class="s1">&#39;:&#39;</span><span class="o">+</span><span class="nx">m</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">m</span><span class="p">.</span><span class="nx">table</span><span class="p">}.{</span><span class="nx">m</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;)}&lt;/ul&gt;;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;list_relationships&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">ListRelationshipsResult</span><span class="p">;</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
<span class="w">          </span><span class="p">{</span><span class="nx">r</span><span class="p">.</span><span class="nx">relationships</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">rel</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">li</span><span class="w"> </span><span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">rel</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">rel</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">rel</span><span class="p">.</span><span class="nx">fromColumn</span><span class="p">}</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="p">{</span><span class="nx">rel</span><span class="p">.</span><span class="nx">toColumn</span><span class="p">}</span><span class="w"> </span><span class="p">(</span><span class="nx">active</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nb">String</span><span class="p">(</span><span class="nx">rel</span><span class="p">.</span><span class="nx">isActive</span><span class="p">)})</span><span class="o">&lt;</span><span class="err">/li&gt;</span>
<span class="w">          </span><span class="p">))}</span>
<span class="w">        </span><span class="o">&lt;</span><span class="err">/ul&gt;</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;list_calculated_columns&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">ListCalculatedColumnsResult</span><span class="p">;</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">r</span><span class="p">.</span><span class="nx">calculated_columns</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">c</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">li</span><span class="w"> </span><span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">c</span><span class="p">.</span><span class="nx">table</span><span class="o">+</span><span class="s1">&#39;:&#39;</span><span class="o">+</span><span class="nx">c</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">c</span><span class="p">.</span><span class="nx">table</span><span class="p">}.{</span><span class="nx">c</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/li&gt;)}&lt;/ul&gt;;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;add_measure&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">AddMeasureResult</span><span class="p">;</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="nx">Added</span><span class="w"> </span><span class="nx">measure</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">r</span><span class="p">.</span><span class="nx">measure_name</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/b&gt; in &lt;code&gt;{r.table_file}&lt;/code&gt;&lt;/div&gt;;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;rename_column&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">RenameColumnResult</span><span class="p">;</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="nx">Renamed</span><span class="w"> </span><span class="nx">column</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">r</span><span class="p">.</span><span class="nx">old_name</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/b&gt; → &lt;b&gt;{r.new_name}&lt;/b&gt; in &lt;code&gt;{r.table_file}&lt;/code&gt;&lt;/div&gt;;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;add_relationship&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">AddRelationshipResult</span><span class="p">;</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="nx">Added</span><span class="w"> </span><span class="nx">relationship</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">code</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">r</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/code&gt; in &lt;code&gt;{r.relationships_file}&lt;/code&gt;&lt;/div&gt;;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;update_relationship&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">UpdateRelationshipResult</span><span class="p">;</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="nx">Updated</span><span class="w"> </span><span class="nx">relationship</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">code</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">r</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/code&gt; in &lt;code&gt;{r.relationships_file}&lt;/code&gt;&lt;/div&gt;;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;tmdl_validate&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">TMDLValidateResult</span><span class="p">;</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="nx">Validation</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">r</span><span class="p">.</span><span class="nx">tables_checked</span><span class="p">}</span><span class="w"> </span><span class="nx">tables</span><span class="p">;</span><span class="w"> </span><span class="nx">relationships</span><span class="w"> </span><span class="nx">present</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nb">String</span><span class="p">(</span><span class="nx">r</span><span class="p">.</span><span class="nx">relationships_present</span><span class="p">)}</span><span class="o">&lt;</span><span class="nx">br</span><span class="o">/&gt;</span><span class="nx">Issues</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">r</span><span class="p">.</span><span class="nx">issues</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;none&#39;</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/div&gt;;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;calculator&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">CalculatorResult</span><span class="p">;</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">suffix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">r</span><span class="p">.</span><span class="nx">note</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="sb">` (</span><span class="si">${</span><span class="nx">r</span><span class="p">.</span><span class="nx">note</span><span class="si">}</span><span class="sb">)`</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">r</span><span class="p">.</span><span class="nx">normalized_expression</span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">r</span><span class="p">.</span><span class="nx">result</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="p">}{</span><span class="nx">suffix</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/div&gt;;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;math_qa&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">MathQAResult</span><span class="p">;</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">r</span><span class="p">.</span><span class="nx">answer</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/div&gt;;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nx">default</span><span class="o">:</span>
<span class="w">      </span><span class="kt">return</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">pre</span><span class="o">&gt;</span><span class="p">{</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">result</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">)}</span><span class="o">&lt;</span><span class="err">/pre&gt;;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="ui-flow-recommendations">
<h2>UI Flow Recommendations<a class="headerlink" href="#ui-flow-recommendations" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Timeline</p>
<ul>
<li><p>Render the user <code class="docutils literal notranslate"><span class="pre">task</span></code> as a chat bubble.</p></li>
<li><p>Show high‑level system steps (delegation_planned / delegation_chosen) in a compact status line.</p></li>
<li><p>For each <code class="docutils literal notranslate"><span class="pre">action_planned</span></code>, show “Using <tool> …”; for <code class="docutils literal notranslate"><span class="pre">action_executed</span></code>, render the tool result (see above).</p></li>
<li><p>On <code class="docutils literal notranslate"><span class="pre">agent_end</span></code>/<code class="docutils literal notranslate"><span class="pre">manager_end</span></code>, mark the run complete and keep the transcript for inspection.</p></li>
</ul>
</li>
<li><p>Errors</p>
<ul>
<li><p>Handle both shapes:</p>
<ul>
<li><p>Agent error: <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">event:</span> <span class="pre">'error',</span> <span class="pre">data:</span> <span class="pre">{</span> <span class="pre">message:</span> <span class="pre">string</span> <span class="pre">}</span> <span class="pre">}</span></code></p></li>
<li><p>WS wrapper error: <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">event:</span> <span class="pre">'error',</span> <span class="pre">data:</span> <span class="pre">{</span> <span class="pre">error:</span> <span class="pre">string</span> <span class="pre">}</span> <span class="pre">}</span></code></p></li>
</ul>
</li>
</ul>
</li>
<li><p>MODEL_DIR</p>
<ul>
<li><p>Do not send it inside tool args; pass <code class="docutils literal notranslate"><span class="pre">model_dir</span></code> at the top‑level request. The server injects it into tool calls.</p></li>
</ul>
</li>
</ul>
</section>
<section id="http-oneshot-response">
<h2>HTTP (One‑Shot) Response<a class="headerlink" href="#http-oneshot-response" title="Link to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/run</span></code> returns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="n">agent</span><span class="p">:</span> <span class="n">string</span><span class="p">,</span>
  <span class="n">task</span><span class="p">:</span> <span class="n">string</span><span class="p">,</span>
  <span class="n">result</span><span class="p">:</span> <span class="nb">any</span><span class="p">,</span>          <span class="o">//</span> <span class="n">final</span> <span class="n">result</span>
  <span class="n">events</span><span class="p">:</span> <span class="n">AgentEvent</span><span class="p">[],</span> <span class="o">//</span> <span class="n">same</span> <span class="n">event</span> <span class="n">shape</span> <span class="k">as</span> <span class="n">WS</span> <span class="n">stream</span>
  <span class="n">memory</span><span class="p">:</span> <span class="nb">any</span><span class="p">[]</span>         <span class="o">//</span> <span class="n">internal</span> <span class="n">memory</span> <span class="n">transcript</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="structured_final_response.html" class="btn btn-neutral float-left" title="Structured Final Response Pattern" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="model_optimization_strategy.html" class="btn btn-neutral float-right" title="Model Optimization Strategy" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Project Authors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>