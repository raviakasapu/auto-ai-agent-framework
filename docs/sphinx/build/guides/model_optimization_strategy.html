

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Model Optimization Strategy &mdash; AI Agent Framework 2.2.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=b21de401"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Python Interpreter Tool - Debugging &amp; Logging Guide" href="python_interpreter_debugging.html" />
    <link rel="prev" title="Frontend Chat Integration Guide" href="frontend_chat_integration.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            AI Agent Framework
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Guides</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#start-here">Start Here</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#howto">Howâ€‘To</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#architecture">Architecture</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#additional-guides">Additional Guides</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="frontend_chat_integration.html">Frontend Chat Integration Guide</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Model Optimization Strategy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#architecture">Architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="#why-this-works">Why This Works</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration-changes">Configuration Changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#environment-variables">Environment Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cost-performance-analysis">Cost-Performance Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#when-to-use-different-models">When to Use Different Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="#monitoring-and-optimization">Monitoring and Optimization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#migration-path">Migration Path</a></li>
<li class="toctree-l4"><a class="reference internal" href="#advanced-configurations">Advanced Configurations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l4"><a class="reference internal" href="#summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="python_interpreter_debugging.html">Python Interpreter Tool - Debugging &amp; Logging Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategic_planning_architecture.html">Strategic Planning Architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="message_store_integration.html">Message Store Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="message_store_format.html">Message Store Format Specification</a></li>
<li class="toctree-l3"><a class="reference internal" href="message_store_implementation.html">Message Store Implementation Guide</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#reference-and-examples">Reference and Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Domain Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../powerbi/index.html">Power BI Domain Example</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Additional Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../framework_guide.html">Framework Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">AI Agent Framework (Overview)</a></li>
<li class="toctree-l1"><a class="reference internal" href="library_architecture.html">Library Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="structured_final_response.html">Structured Final Response Pattern</a></li>
<li class="toctree-l1"><a class="reference internal" href="runtime_loop_stagnation.html">Runtime Loop &amp; Stagnation</a></li>
<li class="toctree-l1"><a class="reference internal" href="observability.html">Observability</a></li>
<li class="toctree-l1"><a class="reference internal" href="message_store_integration.html">Message Store Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="message_store_format.html">Message Store Format Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="message_store_implementation.html">Message Store Implementation Guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">AI Agent Framework</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Guides</a></li>
      <li class="breadcrumb-item active">Model Optimization Strategy</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/guides/model_optimization_strategy.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="model-optimization-strategy">
<h1>Model Optimization Strategy<a class="headerlink" href="#model-optimization-strategy" title="Link to this heading">ïƒ</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">ïƒ</a></h2>
<p>This document describes the optimized model configuration where:</p>
<ul class="simple">
<li><p><strong>GPT-4o (or GPT-5)</strong> is used for strategic planning (complex reasoning)</p></li>
<li><p><strong>GPT-4o-mini</strong> is used for task execution (routine operations)</p></li>
</ul>
<p>This provides the best cost-performance balance.</p>
</section>
<section id="architecture">
<h2>Architecture<a class="headerlink" href="#architecture" title="Link to this heading">ïƒ</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Orchestrator Agent                        â”‚
â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Strategic Planning                          â”‚  â”‚
â”‚  â”‚  Model: GPT-4o (or GPT-5)                   â”‚  â”‚
â”‚  â”‚  - Analyzes user intent                      â”‚  â”‚
â”‚  â”‚  - Creates multi-step plans                  â”‚  â”‚
â”‚  â”‚  - Chooses workers                           â”‚  â”‚
â”‚  â”‚  - Provides strategic context                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â–¼               â–¼               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ React   â”‚    â”‚ Math    â”‚    â”‚ PowerBI  â”‚
    â”‚ Worker  â”‚    â”‚ Worker  â”‚    â”‚ Manager  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                              â”‚
    GPT-4o-mini                         â”‚
    (analysis,                          â”‚
     tool use)                          â”‚
                                        â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚   PowerBI Workers         â”‚
                        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                        â”‚  â”‚ Schema  â”‚ â”‚   DAX   â”‚ â”‚
                        â”‚  â”‚ Editor  â”‚ â”‚ Spec.   â”‚ â”‚
                        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                             GPT-4o-mini
                             (task execution)
</pre></div>
</div>
</section>
<section id="why-this-works">
<h2>Why This Works<a class="headerlink" href="#why-this-works" title="Link to this heading">ïƒ</a></h2>
<section id="strategic-planning-benefits-from-powerful-models">
<h3>Strategic Planning Benefits from Powerful Models<a class="headerlink" href="#strategic-planning-benefits-from-powerful-models" title="Link to this heading">ïƒ</a></h3>
<ul class="simple">
<li><p><strong>Complex reasoning</strong>: Understanding user intent, breaking down problems</p></li>
<li><p><strong>Multi-step planning</strong>: Creating coherent execution strategies</p></li>
<li><p><strong>Worker selection</strong>: Choosing the right combination of specialists</p></li>
<li><p><strong>Context synthesis</strong>: Providing rich guidance to workers</p></li>
</ul>
</section>
<section id="task-execution-benefits-from-efficient-models">
<h3>Task Execution Benefits from Efficient Models<a class="headerlink" href="#task-execution-benefits-from-efficient-models" title="Link to this heading">ïƒ</a></h3>
<ul class="simple">
<li><p><strong>Straightforward operations</strong>: Well-defined tool calls (list_tables, add_relationship)</p></li>
<li><p><strong>Function calling</strong>: OpenAI function calling makes tool selection reliable</p></li>
<li><p><strong>Clear instructions</strong>: Workers receive specific tasks from strategic layer</p></li>
<li><p><strong>Cost savings</strong>: Most tokens spent on execution, not planning</p></li>
</ul>
</section>
</section>
<section id="configuration-changes">
<h2>Configuration Changes<a class="headerlink" href="#configuration-changes" title="Link to this heading">ïƒ</a></h2>
<section id="file-configs-agents-orchestrator-yaml">
<h3>File: <code class="docutils literal notranslate"><span class="pre">configs/agents/orchestrator.yaml</span></code><a class="headerlink" href="#file-configs-agents-orchestrator-yaml" title="Link to this heading">ïƒ</a></h3>
<section id="before-using-gpt-4o-mini-for-everything">
<h4>Before (Using GPT-4o-mini for everything)<a class="headerlink" href="#before-using-gpt-4o-mini-for-everything" title="Link to this heading">ïƒ</a></h4>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">resources</span><span class="p">:</span>
<span class="w">  </span><span class="nt">inference_gateways</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openai-llm</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">OpenAIGateway</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="nt">model</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${OPENAI_MODEL:-gpt-4o-mini}</span>
<span class="w">        </span><span class="nt">api_key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${OPENAI_API_KEY}</span>

<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">planner</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">StrategicPlanner</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">inference_gateway</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openai-llm</span><span class="w">  </span><span class="c1"># Same model for planning</span>
</pre></div>
</div>
</section>
<section id="after-separate-models-for-strategy-and-routing">
<h4>After (Separate models for strategy and routing)<a class="headerlink" href="#after-separate-models-for-strategy-and-routing" title="Link to this heading">ïƒ</a></h4>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">resources</span><span class="p">:</span>
<span class="w">  </span><span class="nt">inference_gateways</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># Strategic planning gateway - uses more powerful model</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openai-strategic</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">OpenAIGateway</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="nt">model</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${OPENAI_STRATEGIC_MODEL:-gpt-4o}</span>
<span class="w">        </span><span class="nt">api_key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${OPENAI_API_KEY}</span>
<span class="w">    </span>
<span class="w">    </span><span class="c1"># Worker routing gateway - uses efficient model (if needed)</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openai-llm</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">OpenAIGateway</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="nt">model</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${OPENAI_MODEL:-gpt-4o-mini}</span>
<span class="w">        </span><span class="nt">api_key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${OPENAI_API_KEY}</span>

<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">planner</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">StrategicPlanner</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">inference_gateway</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openai-strategic</span><span class="w">  </span><span class="c1"># Use powerful model</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="environment-variables">
<h2>Environment Variables<a class="headerlink" href="#environment-variables" title="Link to this heading">ïƒ</a></h2>
<section id="new-environment-variable">
<h3>New Environment Variable<a class="headerlink" href="#new-environment-variable" title="Link to this heading">ïƒ</a></h3>
<p>Create or update your <code class="docutils literal notranslate"><span class="pre">.env</span></code> file:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Strategic Planning Model (for orchestrator&#39;s StrategicPlanner)</span>
<span class="nv">OPENAI_STRATEGIC_MODEL</span><span class="o">=</span>gpt-4o
<span class="c1"># Or when GPT-5 is available:</span>
<span class="c1"># OPENAI_STRATEGIC_MODEL=gpt-5</span>

<span class="c1"># Task Execution Model (for all workers and managers)</span>
<span class="nv">OPENAI_MODEL</span><span class="o">=</span>gpt-4o-mini

<span class="c1"># Your API key</span>
<span class="nv">OPENAI_API_KEY</span><span class="o">=</span>sk-your-key-here
</pre></div>
</div>
</section>
<section id="model-options">
<h3>Model Options<a class="headerlink" href="#model-options" title="Link to this heading">ïƒ</a></h3>
<section id="strategic-planning-choose-one">
<h4>Strategic Planning (Choose One)<a class="headerlink" href="#strategic-planning-choose-one" title="Link to this heading">ïƒ</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gpt-4o</span></code> - Recommended, excellent reasoning at moderate cost</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gpt-5</span></code> - When available, best reasoning (higher cost)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gpt-4-turbo</span></code> - Good alternative to gpt-4o</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">o1-mini</span></code> or <code class="docutils literal notranslate"><span class="pre">o1-preview</span></code> - OpenAIâ€™s reasoning models (if needed)</p></li>
</ul>
</section>
<section id="task-execution-choose-one">
<h4>Task Execution (Choose One)<a class="headerlink" href="#task-execution-choose-one" title="Link to this heading">ïƒ</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gpt-4o-mini</span></code> - Recommended, fast and cost-effective</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gpt-3.5-turbo</span></code> - Even cheaper, but less capable</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gpt-4o</span></code> - If you want consistency across all agents</p></li>
</ul>
</section>
</section>
</section>
<section id="cost-performance-analysis">
<h2>Cost-Performance Analysis<a class="headerlink" href="#cost-performance-analysis" title="Link to this heading">ïƒ</a></h2>
<section id="token-usage-pattern-typical-session">
<h3>Token Usage Pattern (Typical Session)<a class="headerlink" href="#token-usage-pattern-typical-session" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>User: &quot;Find tables with the most relationships and create a summary report&quot;

Orchestrator (Strategic Planning):
â”œâ”€ Input: ~500 tokens (system prompt, task, available workers)
â””â”€ Output: ~200 tokens (strategic plan JSON)
Total: ~700 tokens with GPT-4o

Workers (Task Execution):
â”œâ”€ list_tables: ~300 tokens (gpt-4o-mini)
â”œâ”€ list_relationships: ~400 tokens (gpt-4o-mini)
â”œâ”€ python_interpreter: ~600 tokens (gpt-4o-mini)
â””â”€ Final synthesis: ~800 tokens (gpt-4o-mini)
Total: ~2,100 tokens with GPT-4o-mini
</pre></div>
</div>
</section>
<section id="cost-comparison-approximate">
<h3>Cost Comparison (Approximate)<a class="headerlink" href="#cost-comparison-approximate" title="Link to this heading">ïƒ</a></h3>
<section id="option-1-gpt-4o-for-everything">
<h4>Option 1: GPT-4o for Everything<a class="headerlink" href="#option-1-gpt-4o-for-everything" title="Link to this heading">ïƒ</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Strategic: 700 tokens Ã— $0.005/1K = $0.0035
Tasks: 2,100 tokens Ã— $0.005/1K = $0.0105
Total per session: ~$0.014
</pre></div>
</div>
</section>
<section id="option-2-gpt-4o-strategic-gpt-4o-mini-tasks-recommended">
<h4>Option 2: GPT-4o Strategic + GPT-4o-mini Tasks (Recommended)<a class="headerlink" href="#option-2-gpt-4o-strategic-gpt-4o-mini-tasks-recommended" title="Link to this heading">ïƒ</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Strategic: 700 tokens Ã— $0.005/1K = $0.0035
Tasks: 2,100 tokens Ã— $0.00015/1K = $0.00032
Total per session: ~$0.0038
Cost savings: 73%
</pre></div>
</div>
</section>
<section id="option-3-gpt-4o-mini-for-everything">
<h4>Option 3: GPT-4o-mini for Everything<a class="headerlink" href="#option-3-gpt-4o-mini-for-everything" title="Link to this heading">ïƒ</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Strategic: 700 tokens Ã— $0.00015/1K = $0.0001
Tasks: 2,100 tokens Ã— $0.00015/1K = $0.00032
Total per session: ~$0.00042
But: Lower quality strategic planning
</pre></div>
</div>
</section>
</section>
</section>
<section id="when-to-use-different-models">
<h2>When to Use Different Models<a class="headerlink" href="#when-to-use-different-models" title="Link to this heading">ïƒ</a></h2>
<section id="use-gpt-4o-gpt-5-for-strategic-planning-when">
<h3>Use GPT-4o/GPT-5 for Strategic Planning When:<a class="headerlink" href="#use-gpt-4o-gpt-5-for-strategic-planning-when" title="Link to this heading">ïƒ</a></h3>
<ul class="simple">
<li><p>âœ… Complex multi-agent orchestration</p></li>
<li><p>âœ… Ambiguous user requests requiring interpretation</p></li>
<li><p>âœ… Multi-step workflows with dependencies</p></li>
<li><p>âœ… Need to understand domain-specific context</p></li>
<li><p>âœ… Selecting between many specialized workers</p></li>
</ul>
</section>
<section id="use-gpt-4o-mini-for-task-execution-when">
<h3>Use GPT-4o-mini for Task Execution When:<a class="headerlink" href="#use-gpt-4o-mini-for-task-execution-when" title="Link to this heading">ïƒ</a></h3>
<ul class="simple">
<li><p>âœ… Well-defined tool operations (CRUD operations)</p></li>
<li><p>âœ… Function calling for tool selection</p></li>
<li><p>âœ… Direct questions with clear answers</p></li>
<li><p>âœ… Simple transformations or lookups</p></li>
<li><p>âœ… Following explicit instructions from planner</p></li>
</ul>
</section>
<section id="consider-gpt-4o-for-all-layers-when">
<h3>Consider GPT-4o for All Layers When:<a class="headerlink" href="#consider-gpt-4o-for-all-layers-when" title="Link to this heading">ïƒ</a></h3>
<ul class="simple">
<li><p>âš ï¸ Budget is not a primary concern</p></li>
<li><p>âš ï¸ Maximum quality needed for all operations</p></li>
<li><p>âš ï¸ Complex DAX expression generation</p></li>
<li><p>âš ï¸ Advanced code generation requirements</p></li>
</ul>
</section>
</section>
<section id="monitoring-and-optimization">
<h2>Monitoring and Optimization<a class="headerlink" href="#monitoring-and-optimization" title="Link to this heading">ïƒ</a></h2>
<section id="enable-model-tracking-in-logs">
<h3>Enable Model Tracking in Logs<a class="headerlink" href="#enable-model-tracking-in-logs" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># In configs/agents/orchestrator.yaml</span>
<span class="nt">resources</span><span class="p">:</span>
<span class="w">  </span><span class="nt">subscribers</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">logging</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LoggingSubscriber</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="nt">level</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">INFO</span>
<span class="w">        </span><span class="nt">include_data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">event_levels</span><span class="p">:</span>
<span class="w">          </span><span class="nt">action_planned</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">INFO</span><span class="w">  </span><span class="c1"># See which model is being used</span>
</pre></div>
</div>
</section>
<section id="check-which-model-was-used">
<h3>Check Which Model Was Used<a class="headerlink" href="#check-which-model-was-used" title="Link to this heading">ïƒ</a></h3>
<p>Look for these log entries:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">event</span><span class="o">=</span><span class="n">delegation_planned</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;worker&#39;</span><span class="p">:</span> <span class="s1">&#39;react&#39;</span><span class="p">,</span>
    <span class="s1">&#39;context&#39;</span><span class="p">:</span> <span class="s1">&#39;Created by StrategicPlanner using gpt-4o&#39;</span>
<span class="p">}</span>

<span class="p">[</span><span class="n">DEBUG</span><span class="p">]</span> <span class="n">event</span><span class="o">=</span><span class="n">action_planned</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;list_tables&#39;</span><span class="p">,</span>
    <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;gpt-4o-mini&#39;</span><span class="p">,</span>  <span class="c1"># Worker using cheaper model</span>
    <span class="s1">&#39;gateway&#39;</span><span class="p">:</span> <span class="s1">&#39;openai-llm&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="performance-metrics-to-track">
<h3>Performance Metrics to Track<a class="headerlink" href="#performance-metrics-to-track" title="Link to this heading">ïƒ</a></h3>
<ol class="arabic simple">
<li><p><strong>Planning Quality</strong></p>
<ul class="simple">
<li><p>Are plans coherent and efficient?</p></li>
<li><p>Correct worker selection rate</p></li>
<li><p>Average steps to completion</p></li>
</ul>
</li>
<li><p><strong>Execution Quality</strong></p>
<ul class="simple">
<li><p>Tool call success rate</p></li>
<li><p>Error frequency</p></li>
<li><p>Need for retries</p></li>
</ul>
</li>
<li><p><strong>Cost Metrics</strong></p>
<ul class="simple">
<li><p>Total tokens per session</p></li>
<li><p>Cost per successful task</p></li>
<li><p>Strategic vs. execution token ratio</p></li>
</ul>
</li>
</ol>
</section>
</section>
<section id="migration-path">
<h2>Migration Path<a class="headerlink" href="#migration-path" title="Link to this heading">ïƒ</a></h2>
<section id="step-1-validate-current-setup">
<h3>Step 1: Validate Current Setup<a class="headerlink" href="#step-1-validate-current-setup" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check that strategic planning is working</span>
python<span class="w"> </span>run_agent_app.py
<span class="c1"># Submit a complex task and verify plan quality</span>
</pre></div>
</div>
</section>
<section id="step-2-apply-configuration">
<h3>Step 2: Apply Configuration<a class="headerlink" href="#step-2-apply-configuration" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Update orchestrator.yaml (already done)</span>
<span class="c1"># Add environment variable</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;OPENAI_STRATEGIC_MODEL=gpt-4o&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>.env
</pre></div>
</div>
</section>
<section id="step-3-test-with-both-models">
<h3>Step 3: Test with Both Models<a class="headerlink" href="#step-3-test-with-both-models" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run a test session</span>
python<span class="w"> </span>tests/quick_run.py

<span class="c1"># Check logs for model usage</span>
grep<span class="w"> </span><span class="s2">&quot;StrategicPlanner&quot;</span><span class="w"> </span>logs/agent.log
</pre></div>
</div>
</section>
<section id="step-4-monitor-and-tune">
<h3>Step 4: Monitor and Tune<a class="headerlink" href="#step-4-monitor-and-tune" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compare performance</span>
<span class="c1"># - Strategic plan quality</span>
<span class="c1"># - Worker execution success</span>
<span class="c1"># - Total cost per session</span>

<span class="c1"># Adjust if needed:</span>
<span class="c1"># - Use gpt-5 if strategic planning needs improvement</span>
<span class="c1"># - Keep gpt-4o-mini for workers unless tool calling fails</span>
</pre></div>
</div>
</section>
</section>
<section id="advanced-configurations">
<h2>Advanced Configurations<a class="headerlink" href="#advanced-configurations" title="Link to this heading">ïƒ</a></h2>
<section id="different-models-per-manager">
<h3>Different Models per Manager<a class="headerlink" href="#different-models-per-manager" title="Link to this heading">ïƒ</a></h3>
<p>You can set different models for different manager agents:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># configs/agents/pbi_designer_manager.yaml</span>
<span class="nt">resources</span><span class="p">:</span>
<span class="w">  </span><span class="nt">inference_gateways</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openai-llm</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">OpenAIGateway</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="c1"># Use GPT-4o for complex DAX synthesis</span>
<span class="w">        </span><span class="nt">model</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${OPENAI_PBI_MODEL:-gpt-4o}</span>
<span class="w">        </span><span class="nt">api_key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${OPENAI_API_KEY}</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># In .env</span>
<span class="nv">OPENAI_STRATEGIC_MODEL</span><span class="o">=</span>gpt-4o<span class="w">      </span><span class="c1"># Orchestrator planning</span>
<span class="nv">OPENAI_PBI_MODEL</span><span class="o">=</span>gpt-4o<span class="w">            </span><span class="c1"># PowerBI manager synthesis</span>
<span class="nv">OPENAI_MODEL</span><span class="o">=</span>gpt-4o-mini<span class="w">           </span><span class="c1"># All other workers</span>
</pre></div>
</div>
</section>
<section id="a-b-testing-setup">
<h3>A/B Testing Setup<a class="headerlink" href="#a-b-testing-setup" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Test different strategic models</span>
<span class="nt">resources</span><span class="p">:</span>
<span class="w">  </span><span class="nt">inference_gateways</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openai-strategic-a</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">OpenAIGateway</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="nt">model</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gpt-4o</span>
<span class="w">        </span><span class="nt">api_key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${OPENAI_API_KEY}</span>
<span class="w">    </span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openai-strategic-b</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">OpenAIGateway</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="nt">model</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gpt-5</span><span class="w">  </span><span class="c1"># When available</span>
<span class="w">        </span><span class="nt">api_key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${OPENAI_API_KEY}</span>

<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">planner</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">StrategicPlanner</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="c1"># Toggle between A and B</span>
<span class="w">      </span><span class="nt">inference_gateway</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${STRATEGIC_VARIANT:-openai-strategic-a}</span>
</pre></div>
</div>
</section>
</section>
<section id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Link to this heading">ïƒ</a></h2>
<section id="issue-strategic-plans-are-low-quality">
<h3>Issue: Strategic plans are low quality<a class="headerlink" href="#issue-strategic-plans-are-low-quality" title="Link to this heading">ïƒ</a></h3>
<p><strong>Solution</strong>: Increase model capacity</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">OPENAI_STRATEGIC_MODEL</span><span class="o">=</span>gpt-4o<span class="w">  </span><span class="c1"># or gpt-5</span>
</pre></div>
</div>
</section>
<section id="issue-task-execution-is-slow-expensive">
<h3>Issue: Task execution is slow/expensive<a class="headerlink" href="#issue-task-execution-is-slow-expensive" title="Link to this heading">ïƒ</a></h3>
<p><strong>Solution</strong>: Ensure workers use mini model</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># In worker configs</span>
<span class="nt">resources</span><span class="p">:</span>
<span class="w">  </span><span class="nt">inference_gateways</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openai-llm</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">OpenAIGateway</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="nt">model</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${OPENAI_MODEL:-gpt-4o-mini}</span><span class="w">  </span><span class="c1"># Use mini</span>
</pre></div>
</div>
</section>
<section id="issue-inconsistent-results">
<h3>Issue: Inconsistent results<a class="headerlink" href="#issue-inconsistent-results" title="Link to this heading">ïƒ</a></h3>
<p><strong>Solution</strong>: Add temperature control</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">resources</span><span class="p">:</span>
<span class="w">  </span><span class="nt">inference_gateways</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openai-strategic</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">OpenAIGateway</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="nt">model</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gpt-4o</span>
<span class="w">        </span><span class="nt">temperature</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.7</span><span class="w">  </span><span class="c1"># For creativity in planning</span>
<span class="w">    </span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openai-llm</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">OpenAIGateway</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="nt">model</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gpt-4o-mini</span>
<span class="w">        </span><span class="nt">temperature</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0</span><span class="w">  </span><span class="c1"># For deterministic execution</span>
</pre></div>
</div>
</section>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading">ïƒ</a></h2>
<section id="what-changed">
<h3>What Changed<a class="headerlink" href="#what-changed" title="Link to this heading">ïƒ</a></h3>
<ol class="arabic simple">
<li><p>âœ… Orchestrator now uses <code class="docutils literal notranslate"><span class="pre">openai-strategic</span></code> gateway with GPT-4o</p></li>
<li><p>âœ… Workers continue using <code class="docutils literal notranslate"><span class="pre">openai-llm</span></code> gateway with GPT-4o-mini</p></li>
<li><p>âœ… New environment variable: <code class="docutils literal notranslate"><span class="pre">OPENAI_STRATEGIC_MODEL</span></code></p></li>
</ol>
</section>
<section id="what-to-update">
<h3>What to Update<a class="headerlink" href="#what-to-update" title="Link to this heading">ïƒ</a></h3>
<ol class="arabic simple">
<li><p><strong>Environment file</strong>: Add <code class="docutils literal notranslate"><span class="pre">OPENAI_STRATEGIC_MODEL=gpt-4o</span></code></p></li>
<li><p><strong>No code changes needed</strong>: Configuration handles everything</p></li>
<li><p><strong>Optional</strong>: Add temperature/max_tokens tuning per gateway</p></li>
</ol>
</section>
<section id="expected-results">
<h3>Expected Results<a class="headerlink" href="#expected-results" title="Link to this heading">ïƒ</a></h3>
<ul class="simple">
<li><p>ğŸ“ˆ Better strategic planning (smarter task breakdown)</p></li>
<li><p>ğŸ’° Lower costs (73% reduction vs. all GPT-4o)</p></li>
<li><p>âš¡ Same execution speed (workers already fast)</p></li>
<li><p>ğŸ¯ Better worker selection (GPT-4o understands context better)</p></li>
</ul>
</section>
</section>
<section id="next-steps">
<h2>Next Steps<a class="headerlink" href="#next-steps" title="Link to this heading">ïƒ</a></h2>
<ol class="arabic simple">
<li><p>Test with complex queries and verify plan quality</p></li>
<li><p>Monitor cost savings in production</p></li>
<li><p>Consider GPT-5 for strategic layer when available</p></li>
<li><p>Fine-tune temperature and max_tokens per use case</p></li>
</ol>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="frontend_chat_integration.html" class="btn btn-neutral float-left" title="Frontend Chat Integration Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="python_interpreter_debugging.html" class="btn btn-neutral float-right" title="Python Interpreter Tool - Debugging &amp; Logging Guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Project Authors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>